---
title: "analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(readxl)
data <- read_excel("NIH P1 Emotion Understanding SDS300.xlsx")

data <- janitor::clean_names(data, 'snake')
```


Univariate Analysis:
```{r}
#males vs females in the study
ggplot(data, aes(x = gender_1)) +
  geom_histogram()

summary(data$gender_1)

#distribution of word spans according to gender
ggplot(data, aes(x = word_span)) +
  geom_histogram() +
  facet_grid(vars(gender))

summary(data$word_span)

#age distribution for males vs females
ggplot(data, aes(x = age_1)) +
  geom_histogram() +
  facet_grid(vars(gender))

summary(data$age_1)

#PLS4 score distribution male vs female
ggplot(data, aes(x = pls4comp_raw1)) +
  geom_histogram() +
  facet_grid(vars(gender))

summary(data$pls4comp_raw1)
summary(data$pls4_comp_raw3)
#increase from 1 to 3

#EOWPVT raw score distribution male vs female 
ggplot(data, aes(x = eowpvt_raw1)) +
  geom_histogram() +
  facet_grid(vars(gender))

summary(data$eowpvt_raw1)
summary(data$eowpvt_raw3)
#increase from 1 to 3

#EMO sit 1 distrubution
ggplot(data, aes(x = emo_sit_1)) +
  geom_histogram() +
  facet_grid(vars(gender))

summary(data$emo_sit_1)
summary(data$emo_sit_3)
#only slight inc

#look at total pre emotional score for intervention groups vs no intervention
ggplot(data, aes(x = emo_total_1)) +
  geom_histogram() +
  facet_grid(vars(intervention))

summary((data %>% filter(intervention == 1))$emo_total_1)
summary((data %>% filter(intervention == 0))$emo_total_1)
#both groups start off pretty similar

#look at total post emotional score for intervention groups vs no intervention
ggplot(data, aes(x = emo_total_3)) +
  geom_histogram() +
  facet_grid(vars(intervention))

summary((data %>% filter(intervention == 1))$emo_total_3)
summary((data %>% filter(intervention == 0))$emo_total_3)

#compare emo_total_1 to emo_total_3; did intervention make a difference?
```

Bivariate Analysis
```{r}
#word span vs total emotional score
ggplot(data, aes(x = word_span, y = emo_total_1)) +
  geom_point() +
  geom_jitter()

ggplot(data, aes(x = word_span, y = emo_total_3)) +
  geom_point() +
  geom_jitter()

#it looks like there is a more linear relationship for 3 than 1




#scatterplot between word span and emotion score - do kids with a higher word span have better emotional understanding? 
ggplot(data, aes(x = word_span, y = emo_total_3, color = gender)) +
  geom_point() +
  geom_jitter()
```


try different linear regression models

WORD SPAN VS EMOTION SCORE AT END OF INTERVENTION:
```{r}
#control
mod1 <- lm(emo_total_3 ~ word_span, data = data %>% filter(i_group == 1))
summary(mod1)
#very weak R and R^2, but filtering for intervention improves it

#compare to explicit:
mod1e <- lm(emo_total_3 ~ word_span, data = data %>% filter(i_group == 2))
summary(mod1e)

#compare to implicit:
mod1i <- lm(emo_total_3 ~ word_span, data = data %>% filter(i_group == 3))
summary(mod1i)
```


WORD SPAN VS PLS-4 SCORE AT END OF INTERVENTION:
```{r}
#control
mod2 <- lm(pls4_comp_raw3 ~ word_span, data = data %>% filter(i_group == 1))
summary(mod2)

#explicit emotion group
mod3 <- lm(pls4_comp_raw3 ~ word_span, data = data %>% filter(i_group == 2))
summary(mod3)

#implicit emotion group
mod4 <- lm(pls4_comp_raw3 ~ word_span, data = data%>% filter(i_group == 3))
summary(mod4)
#similar strength to control group
```

WORD SPAN + EOWPVT + PLS-4 SCORESVS EMOTIONAL SCORE AT END OF INTERVENTION:
```{r}
#control
mod5 <- lm(emo_total_3 ~ word_span + eowpvt_raw3 + pls4_comp_raw3, data = data %>% filter(i_group == 1))
summary(mod5)
#basically no linear correlation at all for control group
  
#explicit emotion group
mod6 <- lm(emo_total_3 ~ word_span + eowpvt_raw3 + pls4_comp_raw3, data = data %>% filter(i_group == 2))
summary(mod6)
#more linear correlation for intervention group!

#implicit emotion group
mod6i <- lm(emo_total_3 ~ word_span + eowpvt_raw3 + pls4_comp_raw3, data = data %>% filter(i_group == 3))
summary(mod6i)
```


NEXT: maybe try logistic regression for gender, doing models with binary variables for intervention group?
